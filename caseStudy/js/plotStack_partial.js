function plotStack_partial(t,a,e,r){function n(){deleteRow(),d.selectAll("*").remove(),p.selectAll("*").remove(),v.stackedDataArr=[],v.nailDataArr=[],v.selected=!1,v.selectedNail=-1,v.curDrag=!1,v.toIndex=-2,proporgateStackedArr(v),v.totalAggre=computeTotalAggre(t),updateContribute(t,v),genStackedArr(v,t);var a=!0;plotPartialStack(v,a,0)}function l(t){var a=new Date(1e3*t),e=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],r=a.getFullYear(),n=e[a.getMonth()],l=a.getDate(),o=l+", "+n+" "+r;return o}var o=e.totalW,i=e.totalH,c=e.totalW_nail,s=e.totalH_nail,d=d3.select(a[0]).append("svg").attr("width",o+e.m.left+e.m.right).attr("height",i+e.m.top+e.m.bottom).append("g").attr("transform","translate("+e.m.left+","+e.m.top+")"),p=d3.select(a[1]).append("svg").attr("width",c+e.m_nail.left+e.m_nail.right).attr("height",s+e.m_nail.top+e.m_nail.bottom).append("g").attr("transform","translate("+e.m_nail.left+","+e.m_nail.top+")");d.append("rect").attr("class","overlay").attr("x",0).attr("y",0).attr("width",o).attr("height",i).attr("opacity",0);var u=function(t){return-1==t[r]?"#D1D1D1":e.color(t[r])},m=d3.layout.stack().values(function(t){return t.values}).offset("zero").out(function(t,a,e){t.display={},t.display.x=t.x,t.display.y0=a,t.display.y=e}),g=m(t),f=g[0].values.map(function(t){return parseInt(t.x)});t.forEach(function(t){"#zmapp"==t.lineContent&&(3==t.clusterId&&t.values.forEach(function(t){parseInt(t.x)<=1408838400&&(t.y=5*t.y)}),7==t.clusterId&&t.values.forEach(function(t){parseInt(t.x)>=1410220800&&(t.y=60*t.y)}),-1==t.clusterId&&t.values.forEach(function(t){parseInt(t.x)<1410220800&&parseInt(t.x)<1408838400&&(t.y=10*t.y)}))});var h=d3.max(g.map(function(t){return d3.max(t.values,function(t){return t.display.y0+t.display.y})})),y=0,v={xTickFormat:l,mTop:e.m.top,stackProcess:m,svg:d,nailSVG:p,m:e.m,m_nail:e.m_nail,totalXRange:f,color:u,totalAggre:{},selected:!1,selectedNail:-1,width:o,height:i,width_nail:c,width_perNail:100,height_nail:s,padding:50,padding_nail:50,stackedDataArr:[],nailDataArr:[],listContent:e.listContent,range:{minY:y,maxY:h},rectOffset_nail:{width:10,height:5},curDrag:!1,toIndex:-2};n(),d3.select("#resetBtn").on("click",function(){n()}),deleteRow()}